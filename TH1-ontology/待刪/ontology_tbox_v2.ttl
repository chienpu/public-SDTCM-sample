@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix sosa: <http://www.w3.org/ns/sosa/> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix ifc:  <http://ifcowl.openbimstandards.org/IFC4x3#> .
@prefix bs:   <http://builtinsight.io/ontology/stride#> .

#########################################################################################################
# Semantic Digital Thread (SDT) — Lifecycle Carbon Ontology (TBox v2, Developer-Friendly)
# -------------------------------------------------------------------------------------------------------
# • Scope: TBox only (no individuals / ABox). UTF-8 Turtle.
# • Standards-aligned: BS EN 15978 (Lifecycle Modules), IFC 4x3 (BIM entities), SOSA (IoT/observations),
#   PROV-O (provenance). Custom namespace "bs" provides SDT-specific classes & properties.
# • Goal: Support two calculation chains: (1) Embodied Carbon (A1–A5) and (2) Operational Carbon (B6),
#   while preserving provenance, alignment, and aggregation semantics.
#
# FORMALIZED CALCULATION CHAINS (informative, not executable):
# -------------------------------------------------------------------------------------------------------
# 1) Embodied Carbon
#    CarbonResult (EmbodiedCarbon) = ActivityQuantity × Material × EmissionFactor
#    - alignedWith → LifecycleModule (A1–A5)
#    - wasGeneratedBy → prov:Activity (categorized by BS EN 15978)
#    - Activity used → {Material, EmissionFactor, IFC quantities}
#
# 2) Operational Carbon
#    CarbonResult (OperationalCarbon) = sosa:Observation × EmissionFactor
#    - alignedWith → LifecycleModule (B6)
#    - wasGeneratedBy → prov:Activity (categorized by BS EN 15978)
#    - Activity used → {Observation, EmissionFactor}
#
# WHY NEO4J:
# • Neo4j (via neosemantics) materializes classes/properties as labeled nodes and relationships, enabling
#   graph-native traversal, aggregation, and explainable lineage queries while preserving OWL/RDF semantics.
#########################################################################################################


###############################################################
###  SECTION 1 — CORE CLASSES (taxonomy / alignment targets) ###
###############################################################

### Lifecycle Standard (BS EN 15978) ###########################
bs:LifecycleModule a owl:Class ;
  rdfs:label   "Lifecycle Module (BS EN 15978)" ;
  rdfs:comment "Abstract class for lifecycle modules (A1–A5, B1–B7, C1–C4, D). Use subclasses below." .

# Optional module subclasses (TBox-level only; add instances later in ABox as needed).
bs:A1 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "A1 Raw Material Supply" .
bs:A2 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "A2 Transport" .
bs:A3 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "A3 Manufacturing" .
bs:A4 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "A4 Transport (Construction)" .
bs:A5 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "A5 Construction/Installation" .

bs:B6 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "B6 Operational Energy Use" .
bs:B7 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "B7 Operational Water Use" .

bs:C1 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "C1 De-construction/Demolition" .
bs:C2 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "C2 Transport (End of Life)" .
bs:C3 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "C3 Waste Processing" .
bs:C4 a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "C4 Disposal" .

bs:D  a owl:Class ; rdfs:subClassOf bs:LifecycleModule ; rdfs:label "D Beyond the Life Cycle" .

### Result Layer (Carbon outputs) ##############################
bs:CarbonResult a owl:Class ;
  rdfs:label   "Carbon Result" ;
  rdfs:comment "A computed carbon result (e.g., embodied or operational). Align with a module and preserve provenance." .

bs:EmbodiedCarbon a owl:Class ;
  rdfs:subClassOf bs:CarbonResult ;
  rdfs:label   "Embodied Carbon Result" ;
  rdfs:comment "Carbon result for A1–A5; typically derived from quantities × materials × emission factors." .

bs:OperationalCarbon a owl:Class ;
  rdfs:subClassOf bs:CarbonResult ;
  rdfs:label   "Operational Carbon Result" ;
  rdfs:comment "Carbon result for B6 (energy) / B7 (water), typically observation × emission factor." .

### Material & Factors #########################################
bs:Material a owl:Class ;
  rdfs:label   "Material" ;
  rdfs:comment "Material used by an IFC building element; reference EPDs, density, factors, etc." .

bs:EmissionFactor a owl:Class ;
  rdfs:label   "Emission Factor" ;
  rdfs:comment "Factor used for carbon calculation (e.g., kgCO2e per unit). Decided/selected by a PROV activity." .

bs:ActivityQuantity a owl:Class ;
  rdfs:label   "Activity Quantity" ;
  rdfs:comment "Quantity term for calculations (e.g., volume m^3, mass kg, energy kWh)." .

### Observation Layer ##########################################
sosa:Sensor a owl:Class ; rdfs:label "Sensor" .
sosa:Observation a owl:Class ; rdfs:label "Observation" .

bs:ElectricityMeter a owl:Class ;
  rdfs:subClassOf sosa:Sensor ;
  rdfs:label   "Electricity Meter" ;
  rdfs:comment "A sensor that measures electricity consumption; source for B6 observations." .

### IFC (BIM) ###################################################
ifc:IfcBuildingElement a owl:Class ; rdfs:label "IFC Building Element" .
ifc:IfcAsset           a owl:Class ; rdfs:label "IFC Asset (Building/Campus)" .

### PROV-O ######################################################
prov:Activity a owl:Class ; rdfs:label "Activity" .
prov:Agent    a owl:Class ; rdfs:label "Agent" .


#####################################################################
###  SECTION 2 — OBJECT PROPERTIES (domains/ranges + documentation) #
#####################################################################

### Alignment & aggregation #########################################
bs:alignedWith a owl:ObjectProperty ;
  rdfs:label   "alignedWith" ;
  rdfs:domain  bs:CarbonResult ;
  rdfs:range   bs:LifecycleModule ;
  rdfs:comment "Aligns a CarbonResult with the BS EN 15978 module it quantifies (e.g., A3, B6)." .

bs:aggregates a owl:ObjectProperty ;
  rdfs:label   "aggregates" ;
  rdfs:domain  bs:LifecycleModule ;
  rdfs:range   bs:CarbonResult ;
  rdfs:comment "A module aggregating multiple CarbonResult values (e.g., monthly B6 → annual B6)." .

bs:contributesTo a owl:ObjectProperty ;
  rdfs:label   "contributesTo" ;
  rdfs:domain  ifc:IfcAsset ;
  rdfs:range   ifc:IfcAsset ;
  rdfs:comment "Contribution relationship across assets (e.g., Building contributesTo Campus footprint)." .

### Provenance (PROV-O alignment) ###################################
prov:wasGeneratedBy a owl:ObjectProperty ;
  rdfs:label   "wasGeneratedBy" ;
  rdfs:domain  bs:CarbonResult ;
  rdfs:range   prov:Activity ;
  rdfs:comment "A CarbonResult is generated by an activity (e.g., Calculate_B6_Carbon)." .

prov:wasAttributedTo a owl:ObjectProperty ;
  rdfs:label   "wasAttributedTo" ;
  rdfs:domain  bs:CarbonResult ;
  rdfs:range   prov:Agent ;
  rdfs:comment "Attribution of a result to an agent (system/person)." .

prov:used a owl:ObjectProperty ;
  rdfs:label   "used" ;
  rdfs:domain  prov:Activity ;
  rdfs:range   rdfs:Resource ;
  rdfs:comment "The activity used a resource (e.g., Observation, EmissionFactor, Material, IFC element)." .

prov:wasDerivedFrom a owl:ObjectProperty ;
  rdfs:label   "wasDerivedFrom" ;
  rdfs:domain  bs:ActivityQuantity ;
  rdfs:range   rdfs:Resource ;
  rdfs:comment "Activity quantity derived from a resource (e.g., observation record or IFC takeoff)." .

### Embodied path ###################################################
bs:hasMaterial a owl:ObjectProperty ;
  rdfs:label   "hasMaterial" ;
  rdfs:domain  ifc:IfcBuildingElement ;
  rdfs:range   bs:Material ;
  rdfs:comment "A building element uses a material (for embodied calculations)." .

bs:hasEmissionFactor a owl:ObjectProperty ;
  rdfs:label   "hasEmissionFactor" ;
  rdfs:domain  bs:ActivityQuantity ;
  rdfs:range   bs:EmissionFactor ;
  rdfs:comment "An activity quantity is associated with an emission factor." .

### Operational path ################################################
bs:hasElectricityConsumption a owl:ObjectProperty ;
  rdfs:label   "hasElectricityConsumption" ;
  rdfs:domain  ifc:IfcAsset ;
  rdfs:range   bs:ElectricityMeter ;
  rdfs:comment "An asset has electricity consumption measured by a meter." .

sosa:madeObservation a owl:ObjectProperty ;
  rdfs:label   "madeObservation" ;
  rdfs:domain  sosa:Sensor ;
  rdfs:range   sosa:Observation ;
  rdfs:comment "A sensor made an observation (SOSA pattern)." .

bs:hasObservation a owl:ObjectProperty ;
  rdfs:label   "hasObservation" ;
  rdfs:domain  ifc:IfcAsset ;
  rdfs:range   sosa:Observation ;
  rdfs:comment "An asset has an associated observation (e.g., kWh reading)." .


#############################################################
###  SECTION 3 — DATATYPE PROPERTIES (numeric/meta fields) ###
#############################################################

bs:value a owl:DatatypeProperty ;
  rdfs:label   "value" ;
  rdfs:domain  bs:CarbonResult ;
  rdfs:range   xsd:decimal ;
  rdfs:comment "Numeric GWP value (e.g., kgCO2e)." .

bs:unit a owl:DatatypeProperty ;
  rdfs:label   "unit" ;
  rdfs:domain  rdfs:Resource ;
  rdfs:range   xsd:string ;
  rdfs:comment "Unit string (e.g., kgCO2e, kWh, m3)." .

bs:uncertainty a owl:DatatypeProperty ;
  rdfs:label   "uncertainty" ;
  rdfs:domain  bs:CarbonResult ;
  rdfs:range   xsd:float ;
  rdfs:comment "Optional uncertainty associated with the CarbonResult." .

bs:confidenceScore a owl:DatatypeProperty ;
  rdfs:label   "confidenceScore" ;
  rdfs:domain  bs:CarbonResult ;
  rdfs:range   xsd:float ;
  rdfs:comment "Optional confidence score (0–1)." .


#########################################################################################################
# NOTES FOR ABOX (Instances to be added later via ETL / integration):
# • Embodied:   IfcBuildingElement --hasMaterial--> Material ; ActivityQuantity --hasEmissionFactor--> EmissionFactor
#               Activity (Calculate_A*) --used--> {Material, EmissionFactor, IFC quantities}
#               CarbonResult (EmbodiedCarbon) --alignedWith--> A1..A5 ; --wasGeneratedBy--> Activity
#
# • Operational: IfcAsset --hasElectricityConsumption--> ElectricityMeter --madeObservation--> Observation
#                Activity (Calculate_B6) --used--> {Observation, EmissionFactor}
#                CarbonResult (OperationalCarbon) --alignedWith--> B6 ; --wasGeneratedBy--> Activity
#
# • Aggregation: LifecycleModule --aggregates--> CarbonResult (e.g., SUM over B6 results by period/asset).
#########################################################################################################
